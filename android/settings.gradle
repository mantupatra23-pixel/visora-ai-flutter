// ‚úÖ Cloud-ready Flutter Gradle Configuration for Visora AI

pluginManagement {
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
    }

    // üß† Detect Flutter SDK path (for GitHub Cloud Runner)
    def flutterSdkPath = System.getenv("FLUTTER_HOME")
    if (flutterSdkPath == null || flutterSdkPath.isEmpty()) {
        // ‚úÖ Fallback for local build (when running on mobile or local PC)
        flutterSdkPath = "${rootDir.getAbsoluteFile().getParentFile().path}/.flutter"
    }

    println("üîç Using Flutter SDK path: " + flutterSdkPath)

    // ‚úÖ Safely include Flutter SDK build if it exists
    def flutterDir = new File(flutterSdkPath)
    if (flutterDir.exists()) {
        includeBuild(flutterSdkPath)
    } else {
        println("‚ö†Ô∏è Flutter SDK path not found at: ${flutterSdkPath} (Skipping includeBuild)")
    }
}

dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.PREFER_SETTINGS)
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
    }
}

rootProject.name = "visora_ai_flutter"
include(":app")

// ‚úÖ Flutter plugin dependency check
def flutterPluginsFile = new File(rootDir, "../.flutter-plugins-dependencies")
if (flutterPluginsFile.exists()) {
    println("‚úÖ Flutter plugin dependencies found at: ${flutterPluginsFile.absolutePath}")
} else {
    println("‚ö†Ô∏è Flutter plugin dependencies not found. Flutter will regenerate them automatically.")
}
